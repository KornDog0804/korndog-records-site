<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Hand-picked vinyl records, Funkos & collectibles for music lovers. Vinyl therapy always on deck at KornDog Records."/>
  <meta name="theme-color" content="#3b2aa2"/>
  <title>KornDog Records â€¢ Vinyl Therapy & Collectibles</title>
  <link rel="icon" href="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/ChatGPT%20Image%20Aug%2010%2C%202025%2C%2012_07_42%20AM.png"/>
  <script id="paypal-sdk" src="https://www.paypal.com/sdk/js?client-id=test&currency=USD" data-client="REPLACE_WITH_LIVE_CLIENT_ID"></script>
  <style>
    :root{--bg1:#3b2aa2;--bg2:#0fa77f;--ink:#eaf4ff;--muted:#b6c2d1;--card:#0b1220;--green:hsl(142 76% 36%);--green2:hsl(142 76% 46%);--accent:#ffd166;}
    *{box-sizing:border-box}html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Helvetica,Arial,sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:var(--ink)}
    a{color:inherit;text-decoration:none}
    .btn{background:#0e1624;border:1px solid #253146;color:#d7e3f4;border-radius:10px;padding:10px 16px;cursor:pointer;transition:all 0.2s;font-size:14px;min-height:44px}
    .btn:hover{background:#151f31}
    .btn.primary{background:var(--green);border-color:var(--green);color:#fff}
    .btn.primary:hover{background:var(--green2)}
    .btn.ghost{background:transparent;border-color:#38465f}
    .badge{background:#121827;border:1px solid #243041;color:#a3d2ff;border-radius:999px;padding:2px 7px;margin-left:6px}
    .small{font-size:12px;color:#9fb4c9}
    .muted{font-size:12px;color:#9fb4c9}
    .grow{flex:1}
    .row2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .nav{position:sticky;top:0;z-index:50;background:rgba(11,18,32,.9);backdrop-filter:blur(8px);border-bottom:1px solid rgba(255,255,255,.1);padding:12px 16px;display:flex;justify-content:space-between;align-items:center}
    .nav .brand{display:flex;gap:10px;align-items:center;font-weight:800;color:var(--accent);cursor:pointer}
    .nav .brand img{width:28px;height:28px;border-radius:50%}
    .nav .links{display:flex;gap:10px;align-items:center}
    main{min-height:calc(100vh - 58px)}
    .page{display:none}.page.active{display:block}
    .hero{min-height:90vh;display:grid;place-items:center;text-align:center;padding:40px 20px}
    .hero-logo{width:320px;height:320px;border-radius:50%;background:rgba(255,255,255,.15);border:2px solid rgba(255,255,255,.35);backdrop-filter:blur(8px);display:grid;place-items:center;margin-bottom:30px;cursor:pointer;user-select:none}
    .hero-logo img{width:240px;height:240px;object-fit:contain;border-radius:50%}
    .hero h1{font-size:56px;margin:20px 0;font-weight:900;line-height:1.1}
    .sub{color:#dfe9f8;max-width:800px;margin:0 auto 30px;font-size:22px;line-height:1.4}
    .cta{display:flex;gap:20px;justify-content:center;margin:40px 0}
    .cta .btn{padding:20px 32px;font-size:20px;font-weight:600;min-height:64px;border-radius:12px}
    .features{display:grid;grid-template-columns:repeat(4,minmax(100px,1fr));gap:20px;max-width:700px;margin:50px auto}
    .features .feat{background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.25);border-radius:16px;display:grid;place-items:center;padding:24px;min-height:120px}
    .features .feat i{font-size:36px;margin-bottom:10px}
    .features .feat span{font-size:18px;font-weight:600}
    .container{max-width:1200px;margin:0 auto;padding:18px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
    .card{background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.1);border-radius:14px;overflow:hidden;transition:transform 0.2s}
    .card:hover{transform:translateY(-2px)}
    .card img{display:block;width:100%;height:200px;object-fit:cover;background:#0b1220}
    .card .pad{padding:14px}
    .store-head{display:flex;justify-content:space-between;align-items:center;gap:15px;flex-wrap:wrap;margin-bottom:24px}
    .tabs{display:flex;gap:10px;flex-wrap:wrap}
    .tab{background:#0f1729;border:1px solid #273043;color:#d7e3f4;border-radius:8px;padding:8px 14px;cursor:pointer;transition:all 0.2s;min-height:40px}
    .tab.active,.tab:hover{background:#172136}
    .item-title{font-weight:800;margin:8px 0 6px;font-size:16px}
    .price{color:#c4e6ff;margin-bottom:12px;font-size:18px;font-weight:600}
    .row{display:flex;justify-content:space-between;align-items:center;margin:8px 0;gap:8px}
    .total{font-size:18px;border-top:1px solid #233046;padding-top:8px;margin-top:8px}
    .drawer{position:fixed;top:0;right:-440px;width:440px;max-width:95vw;height:100vh;background:#0c1423;color:#eaf4ff;border-left:1px solid #253146;transition:right .3s ease;display:flex;flex-direction:column;z-index:60}
    .drawer.open{right:0}
    .drawer header{display:flex;justify-content:space-between;align-items:center;padding:14px;border-bottom:1px solid #223045}
    .drawer main{flex:1;overflow:auto;padding:14px}
    .cart-item{display:flex;gap:12px;border:1px solid #223045;border-radius:10px;padding:12px;margin-bottom:10px}
    .cart-item img{width:64px;height:64px;object-fit:cover;border-radius:8px}
    .drawer footer{border-top:1px solid #223045;padding:14px}
    .paypal{margin-top:12px}
    .admin{position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(3px);display:none;z-index:80}
    .admin.show{display:block}
    .admin-inner{position:absolute;right:0;top:0;width:100%;max-width:980px;height:100%;background:#0b1220;border-left:1px solid #223045;overflow:auto}
    .adm-head{display:flex;justify-content:space-between;align-items:center;padding:14px;border-bottom:1px solid #223045}
    .admin-grid{display:grid;grid-template-columns:380px 1fr;gap:14px;padding:14px}
    .admin-card{background:#0e1628;border:1px solid #223145;border-radius:12px;padding:14px}
    .admin-card h3{margin:6px 0 12px;color:#c4e6ff}
    label{display:block;font-size:13px;margin:10px 0;color:#cfe0ff}
    input,select,textarea{width:100%;background:#0b1322;border:1px solid #273246;color:#e6f1ff;border-radius:8px;padding:9px;margin-top:6px}
    input:focus,select:focus,textarea:focus{outline:none;border-color:var(--green)}
    .photo-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin:10px 0}
    .ph{background:#0b1322;border:1px solid #273246;border-radius:10px;padding:10px;text-align:center;cursor:pointer}
    .ph:hover{border-color:#38465f}
    .ph img{width:100%;height:120px;object-fit:cover;border-radius:8px;margin-bottom:8px}
    .ph span{font-size:12px;color:#9fb4c9}
    .ph input{display:none}
    #adminList .row{align-items:flex-start;gap:10px;border-bottom:1px solid #1a2332;padding:10px 0}
    .kitty{position:fixed;bottom:20px;left:20px;display:none;align-items:center;gap:12px;z-index:1000}
    .kitty.show{display:flex;animation:slideIn .3s ease}
    .kitty img{width:70px;height:70px;border-radius:50%;object-fit:cover;box-shadow:0 6px 20px rgba(0,0,0,.4)}
    .bubble{background:#fff;color:#141a22;border:3px solid #141a22;border-radius:18px;padding:12px 16px;font-weight:800;position:relative;max-width:200px}
    .bubble::after{content:'';position:absolute;left:-10px;top:50%;transform:translateY(-50%);border:10px solid transparent;border-right-color:#141a22}
    .thank-you-kitties{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;gap:60px;z-index:2000}
    .thank-you-kitties.show{display:flex;animation:thankYou .4s ease}
    .thank-kitty{display:flex;flex-direction:column;align-items:center;gap:16px}
    .thank-kitty img{width:140px;height:140px;border-radius:50%;object-fit:cover;box-shadow:0 10px 30px rgba(0,0,0,.5)}
    .thank-bubble{background:#fff;color:#141a22;border:3px solid #141a22;border-radius:18px;padding:14px 20px;font-weight:800;text-align:center;min-width:200px}
    .about-hero{min-height:100vh;background:linear-gradient(135deg,#ff006e,#8338ec,#3a86ff);position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}
    .about-hero::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-image:url('https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/Screenshot_20250827-140949.png');background-size:contain;background-repeat:no-repeat;background-position:center;opacity:0.12;z-index:1}
    .about-content{position:relative;z-index:2;max-width:800px;padding:40px 24px;text-align:center}
    .about-content h2{font-size:42px;margin-bottom:30px;text-shadow:2px 2px 4px rgba(0,0,0,0.4)}
    .about-content h3{color:#ff69b4;margin-top:40px;margin-bottom:20px;text-shadow:1px 1px 2px rgba(0,0,0,0.3)}
    .about-content p{font-size:18px;line-height:1.6;margin-bottom:20px;text-shadow:1px 1px 2px rgba(0,0,0,0.3)}
    @keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}
    @keyframes thankYou{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:scale(1)}}
    @media(max-width:860px){
      .admin-grid{grid-template-columns:1fr}
      .cta{flex-direction:column;align-items:center;gap:12px}
      .features{grid-template-columns:repeat(2,1fr);gap:12px}
      .hero{padding:32px 20px}
      .hero h1{font-size:32px}
      .sub{font-size:16px;padding:0 16px}
      .btn{padding:12px 18px;font-size:16px;min-height:48px}
      .hero-logo{width:180px;height:180px}
      .hero-logo img{width:130px;height:130px}
      .grid{grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:18px}
      .about-content{padding:50px 24px}
      .about-content h2{font-size:36px}
      .about-content p{font-size:17px}
      .thank-you-kitties{gap:40px;flex-direction:column}
      .drawer{width:100vw;max-width:100vw}
    }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="brand" onclick="showPage('home')">
      <img src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/ChatGPT%20Image%20Aug%2010%2C%202025%2C%2012_07_42%20AM.png" alt="KornDog"/>
      <span>KornDog Records</span>
    </div>
    <div class="links">
      <a href="#" onclick="showPage('home')">Home</a>
      <a href="#" onclick="showPage('store')">Shop</a>
      <a href="#" onclick="showPage('about')">About</a>
      <button class="btn" onclick="openCart()">Cart <span id="cartCount" class="badge">0</span></button>
    </div>
  </nav>

  <main>
    <section id="home" class="page active">
      <div class="hero">
        <div class="hero-logo" onclick="window.adminTap()" title="Tap KornDog Logo 5Ã— for Admin">
          <img src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/ChatGPT%20Image%20Aug%2010%2C%202025%2C%2012_07_42%20AM.png" alt="KornDog Logo"/>
        </div>
        <h1>Vinyl Therapy Always On Deck</h1>
        <p class="sub">Hand-picked records, funkos & collectibles for music lovers and pop culture enthusiasts</p>
        <div class="cta">
          <button class="btn primary" onclick="showPage('store')">Enter The Shop</button>
          <button class="btn" onclick="showPage('about')">About</button>
        </div>
        <div class="features">
          <div class="feat"><i>ðŸ’½</i><span>Vinyl</span></div>
          <div class="feat"><i>ðŸ’¿</i><span>CDs</span></div>
          <div class="feat"><i>ðŸ¤–</i><span>Funkos</span></div>
          <div class="feat"><i>ðŸŽ®</i><span>Collectibles</span></div>
        </div>
      </div>
    </section>

    <section id="store" class="page">
      <div class="container">
        <header class="store-head">
          <h2>Explore Our Collections</h2>
          <div class="tabs">
            <button class="tab active" onclick="filterProducts('all',this)">All</button>
            <button class="tab" onclick="filterProducts('vinyl',this)">Vinyl</button>
            <button class="tab" onclick="filterProducts('cd',this)">CDs</button>
            <button class="tab" onclick="filterProducts('funko',this)">Funkos</button>
            <button class="tab" onclick="filterProducts('collectible',this)">Collectibles</button>
          </div>
        </header>
        <div id="grid" class="grid"></div>
      </div>
    </section>

    <section id="about" class="page">
      <div class="about-hero">
        <div class="about-content">
          <h2>About Me (Korndog Records)</h2>
          <p>Music's always been in my blood â€” thanks to my mom and dad â€” but vinyl didn't hit me 'til after my mom's wreck. She didn't make it. That moment split my world in two. Records became therapy. No therapist. No pills. Just needle to groove. It grounded me. Every spin pulls me back â€” riding shotgun with my old man, laughing with my kids, slow dancing with my wife.</p>
          <p>This site? It's not about algorithms, trends, or fake hype. It's about soul. About stories. About memories you can hear. Every record here means something. It's not just wax â€” it's a vibe. A scar. A time machine.</p>
          <p>If you get it, you get it.</p>
          <p>Welcome to Korndog Records â€” where vinyl therapy is always on deck</p>
          <h3>Zombie Kitty Story</h3>
          <p>Zombie Kitty isn't just a mascot â€” she's family. She was born out of a Friday the 13th tattoo session with my daughter Elizabeth. Purple rose eye, stitched-up smile â€” part nightmare, part love letter. She's a reminder that scars can be turned into art, that even the broken pieces still tell a story.</p>
          <p>For Korndog Records, Zombie Kitty lives in the grooves. She pops up when the music hits that raw nerve â€” the scratchy edges, the late-night confessions, the songs that refuse to die. Just like her, vinyl never really fades. It comes back to life every time the needle drops.</p>
          <div class="cta">
            <button class="btn primary" onclick="showPage('store')">Start Your Collection</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <aside id="drawer" class="drawer">
    <header><strong>Your Cart</strong><button class="btn" onclick="closeCart()">Close</button></header>
    <main id="cartList"></main>
    <footer>
      <div class="row"><span>Subtotal:</span><strong id="subtotal">$0.00</strong></div>
      <div class="row small"><span>Discount:</span><span id="discount">$0.00</span></div>
      <div class="row small"><span>Tax (6%):</span><span id="tax">$0.00</span></div>
      <div class="row total"><span>Total:</span><strong id="grand">$0.00</strong></div>
      <div id="paypal-buttons" class="paypal"></div>
      <button class="btn ghost" onclick="clearCart()" style="width:100%;margin-top:12px">Clear cart</button>
    </footer>
  </aside>

  <div id="admin" class="admin">
    <div class="admin-inner">
      <div class="adm-head"><strong>Admin Panel</strong><button class="btn" onclick="hideAdmin()">Close</button></div>
      <div class="admin-grid">
        <form id="prodForm" onsubmit="saveProduct(event)" class="admin-card">
          <h3>Add / Edit Product</h3>
          <label>Title<input id="pTitle" required></label>
          <div class="row2">
            <label>Category<select id="pType" required><option value="vinyl">Vinyl</option><option value="cd">CD</option><option value="funko">Funko</option><option value="collectible">Collectible</option></select></label>
            <label>Price ($)<input id="pPrice" type="number" step="0.01" required onblur="snapPrice(this)"><small class="muted">Snaps to .99 or .59</small></label>
          </div>
          <div class="photo-grid">
            <div class="ph" onclick="$('#pFront').click()">
              <img id="prevFront" src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/ChatGPT%20Image%20Aug%2010%2C%202025%2C%2012_07_42%20AM.png" alt="Front"/>
              <input id="pFront" type="file" accept="image/*" capture="environment" onchange="readImage(this,'prevFront')">
              <span>Front</span>
            </div>
            <div class="ph" onclick="$('#pBack').click()">
              <img id="prevBack" src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/Screenshot_20250827-140949.png" alt="Back"/>
              <input id="pBack" type="file" accept="image/*" capture="environment" onchange="readImage(this,'prevBack')">
              <span>Back</span>
            </div>
            <div class="ph" onclick="$('#pAlt1').click()">
              <img id="prevAlt1" src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/1000043471-removebg-preview.png" alt="Alt1"/>
              <input id="pAlt1" type="file" accept="image/*" capture="environment" onchange="readImage(this,'prevAlt1')">
              <span>Alt 1</span>
            </div>
            <div class="ph" onclick="$('#pAlt2').click()">
              <img id="prevAlt2" src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/ChatGPT%20Image%20Aug%2010%2C%202025%2C%2012_07_42%20AM.png" alt="Alt2"/>
              <input id="pAlt2" type="file" accept="image/*" capture="environment" onchange="readImage(this,'prevAlt2')">
              <span>Alt 2</span>
            </div>
          </div>
          <label>Description<textarea id="pDesc" rows="3" placeholder="Grade, condition, notesâ€¦"></textarea></label>
          <button class="btn primary" type="submit">Save Product</button>
        </form>
        <div class="admin-card">
          <h3>Inventory Management</h3>
          <div id="adminList"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="kitty" class="kitty">
    <img id="kittyImg" src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/Screenshot_20250827-140949.png" alt="Kitty"/>
    <div id="kittyMsg" class="bubble">Added to cart!</div>
  </div>

  <div id="thankYouKitties" class="thank-you-kitties">
    <div class="thank-kitty">
      <img src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/Screenshot_20250827-140949.png" alt="Zombie Kitty"/>
      <div class="thank-bubble">Thank you very much...</div>
    </div>
    <div class="thank-kitty">
      <img src="https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/1000043471-removebg-preview.png" alt="Chibi Kitty"/>
      <div class="thank-bubble">Come back now ya hear!</div>
    </div>
  </div>

  <script>
    // Constants and globals
    const LOGO = "https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/ChatGPT%20Image%20Aug%2010%2C%202025%2C%2012_07_42%20AM.png";
    const ZOMBIE = "https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/Screenshot_20250827-140949.png";
    const CHIBI = "https://raw.githubusercontent.com/KornDog0804/korndog-records-site/main/1000043471-removebg-preview.png";
    const TAX_RATE = 0.06;
    const DISCOUNT_LADDER = [
      {threshold: 50, percent: 5},
      {threshold: 100, percent: 10},
      {threshold: 200, percent: 15}
    ];
    
    let products = [];
    let cart = [];
    let filterKey = 'all';
    let editId = null;
    let adminTaps = 0;
    
    const $ = s => document.querySelector(s);
    const fmt = n => '$' + (Math.round(n * 100) / 100).toFixed(2);

    function snapPrice(input) {
      let value = parseFloat(input.value || 0);
      if (isNaN(value)) return;
      const cents = Math.round((value - Math.floor(value)) * 100);
      const dollars = Math.floor(value);
      const snap59 = Math.abs(cents - 59) < Math.abs(cents - 99);
      input.value = (dollars + (snap59 ? 0.59 : 0.99)).toFixed(2);
    }

    function readImage(input, targetId) {
      const file = input.files && input.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => document.getElementById(targetId).src = e.target.result;
      reader.readAsDataURL(file);
    }

    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
    }

    function showAdmin() {
      console.log('Attempting to show admin panel...');
      const adminPanel = document.getElementById('admin');
      if (adminPanel) {
        adminPanel.classList.add('show');
        console.log('Admin panel should now be visible');
        renderAdmin();
      } else {
        console.error('Admin panel element not found!');
      }
    }

    function openAdminWithPassword() {
      const password = prompt('Enter admin password:');
      if (password === 'vinyltherapy') {
        showAdmin();
      } else if (password !== null) {
        alert('Access denied. Wrong password.');
      }
      adminTaps = 0;
    }

    function handleAdminTap() {
      if (!window.adminTaps) window.adminTaps = 0;
      window.adminTaps++;
      console.log('Admin taps:', window.adminTaps);
      
      if (window.adminTaps >= 5) {
        window.adminTaps = 0;
        var password = prompt('Enter admin password:');
        if (password === 'vinyltherapy') {
          var adminElement = document.getElementById('admin');
          if (adminElement) {
            adminElement.style.display = 'block';
            renderAdmin();
            console.log('Admin panel opened successfully');
          } else {
            console.error('Could not find admin element');
          }
        } else if (password !== null) {
          alert('Access denied.');
        }
      }
      
      // Reset after 8 seconds
      setTimeout(function() {
        window.adminTaps = 0;
      }, 8000);
    }

    function hideAdmin() {
      var adminElement = document.getElementById('admin');
      if (adminElement) {
        adminElement.style.display = 'none';
      }
    }

    function loadProducts() {
      try {
        const stored = localStorage.getItem('kdr_products');
        products = stored ? JSON.parse(stored) : [];
      } catch (e) {
        products = [];
      }
      
      if (!Array.isArray(products) || products.length === 0) {
        products = [
          {
            id: 'default_1',
            title: 'Mystery Vinyl',
            type: 'vinyl',
            price: 15.99,
            imgFront: ZOMBIE,
            imgBack: LOGO,
            desc: 'Surprise pull - guaranteed heat'
          },
          {
            id: 'default_2',
            title: 'Eddie Van Halen',
            type: 'funko',
            price: 25.99,
            imgFront: CHIBI,
            imgBack: LOGO,
            desc: 'Guitar legend collectible'
          },
          {
            id: 'default_3',
            title: 'Aerosmith - Get a Grip',
            type: 'cd',
            price: 5.99,
            imgFront: LOGO,
            imgBack: ZOMBIE,
            desc: 'Classic rock essential'
          }
        ];
        saveProducts();
      }
    }

    function saveProducts() {
      try {
        localStorage.setItem('kdr_products', JSON.stringify(products));
      } catch (e) {
        console.log('Storage not available');
      }
    }

    function saveProduct(event) {
      event.preventDefault();
      const title = document.getElementById('pTitle').value.trim();
      const type = document.getElementById('pType').value;
      const price = parseFloat(document.getElementById('pPrice').value || 0);
      const desc = document.getElementById('pDesc').value.trim();
      const imgFront = document.getElementById('prevFront').src;
      const imgBack = document.getElementById('prevBack').src;
      const alt1 = document.getElementById('prevAlt1').src;
      const alt2 = document.getElementById('prevAlt2').src;
      
      if (!title || !type || !price) return;
      
      const product = {
        id: editId || 'prod_' + Date.now(),
        title: title,
        type: type,
        price: price,
        desc: desc,
        imgFront: imgFront,
        imgBack: imgBack,
        alt1: alt1,
        alt2: alt2
      };
      
      if (editId) {
        const index = products.findIndex(p => p.id === editId);
        if (index > -1) products[index] = product;
      } else {
        products.unshift(product);
      }
      
      editId = null;
      saveProducts();
      render();
      renderAdmin();
      event.target.reset();
      document.getElementById('prevFront').src = LOGO;
      document.getElementById('prevBack').src = ZOMBIE;
      document.getElementById('prevAlt1').src = CHIBI;
      document.getElementById('prevAlt2').src = LOGO;
    }

    function deleteProduct(id) {
      if (confirm('Delete this product?')) {
        products = products.filter(p => p.id !== id);
        saveProducts();
        render();
        renderAdmin();
      }
    }

    function editProduct(id) {
      const product = products.find(p => p.id === id);
      if (!product) return;
      
      editId = id;
      document.getElementById('pTitle').value = product.title;
      document.getElementById('pType').value = product.type;
      document.getElementById('pPrice').value = product.price.toFixed(2);
      document.getElementById('pDesc').value = product.desc || '';
      document.getElementById('prevFront').src = product.imgFront || LOGO;
      document.getElementById('prevBack').src = product.imgBack || ZOMBIE;
      document.getElementById('prevAlt1').src = product.alt1 || CHIBI;
      document.getElementById('prevAlt2').src = product.alt2 || LOGO;
      window.scrollTo({top: 0, behavior: 'smooth'});
    }

    function filterProducts(key, button) {
      filterKey = key;
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      if (button) button.classList.add('active');
      render();
    }

    function render() {
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      const list = filterKey === 'all' ? products : products.filter(p => p.type === filterKey);
      
      if (list.length === 0) {
        grid.innerHTML = '<div class="card pad">No items yet.</div>';
        return;
      }
      
      list.forEach(product => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="${product.imgFront || LOGO}" alt="${product.title}"/>
          <div class="pad">
            <div class="item-title">${product.title}</div>
            <div class="price">${fmt(product.price)}</div>
            <div class="row">
              <button class="btn" onclick="viewProduct('${product.id}')">View</button>
              <button class="btn primary" onclick="addToCart('${product.id}')">Add</button>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    function viewProduct(id) {
      const product = products.find(p => p.id === id);
      if (product) {
        alert(product.title + '\n\n' + (product.desc || ''));
      }
    }

    function loadCart() {
      try {
        const stored = localStorage.getItem('kdr_cart');
        cart = stored ? JSON.parse(stored) : [];
      } catch (e) {
        cart = [];
      }
      updateCartCount();
    }

    function saveCart() {
      try {
        localStorage.setItem('kdr_cart', JSON.stringify(cart));
      } catch (e) {
        console.log('Storage not available');
      }
      updateCartCount();
    }

    function updateCartCount() {
      const count = cart.reduce((total, item) => total + (item.qty || 1), 0);
      document.getElementById('cartCount').textContent = count;
    }

    function addToCart(id) {
      const product = products.find(p => p.id === id);
      if (!product) return;
      
      const existingIndex = cart.findIndex(item => item.id === id);
      if (existingIndex > -1) {
        cart[existingIndex].qty += 1;
      } else {
        cart.push({
          id: id,
          title: product.title,
          price: product.price,
          img: product.imgFront,
          qty: 1
        });
      }
      
      saveCart();
      renderCart();
      openCart();
      showToast('add', product.type);
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      saveCart();
      renderCart();
      showToast('remove', 'vinyl');
    }

    function clearCart() {
      if (confirm('Clear entire cart?')) {
        cart = [];
        saveCart();
        renderCart();
      }
    }

    function openCart() {
      document.querySelector('.drawer').classList.add('open');
    }

    function closeCart() {
      document.querySelector('.drawer').classList.remove('open');
    }

    function showToast(action, type) {
      const kitty = document.getElementById('kitty');
      const msg = document.getElementById('kittyMsg');
      const img = document.getElementById('kittyImg');
      
      const addBlurbs = [
        "KAPOW! Another one for the collection!",
        "Holy groove, Batman! Cart secured!",
        "Boom! Your therapy session just got better!",
        "By the power of wax... ADDED!",
        "That's what I call vinyl justice!",
        "Bam! Pure audio therapy activated!"
      ];
      
      const removeBlurbs = [
        "Poof! Banished to the shadow realm!",
        "Holy vanishing act, Batman!",
        "Zap! Back to the vinyl void!",
        "Gone but not forgotten... maybe!",
        "Another one bites the dust!",
        "Whoosh! Into the abyss it goes!"
      ];
      
      if (action === 'add') {
        msg.textContent = addBlurbs[Math.floor(Math.random() * addBlurbs.length)];
        img.src = type === 'vinyl' ? ZOMBIE : CHIBI;
      } else {
        msg.textContent = removeBlurbs[Math.floor(Math.random() * removeBlurbs.length)];
        img.src = ZOMBIE;
      }
      
      kitty.classList.add('show');
      setTimeout(() => kitty.classList.remove('show'), 3500);
    }

    function showThankYou() {
      const thanks = document.getElementById('thankYouKitties');
      thanks.classList.add('show');
      setTimeout(() => thanks.classList.remove('show'), 4500);
    }

    function renderCart() {
      const cartList = document.getElementById('cartList');
      cartList.innerHTML = '';
      let subtotal = 0;
      
      cart.forEach((item, index) => {
        subtotal += item.price * item.qty;
        const row = document.createElement('div');
        row.className = 'cart-item';
        row.innerHTML = `
          <img src="${item.img || LOGO}" alt="${item.title}"/>
          <div class='grow'>
            <div><strong>${item.title}</strong></div>
            <div class='small'>${item.qty} Ã— $${item.price.toFixed(2)}</div>
          </div>
          <button class='btn' onclick='removeFromCart(${index})'>Remove</button>
        `;
        cartList.appendChild(row);
      });
      
      let discount = 0;
      for (const tier of DISCOUNT_LADDER) {
        if (subtotal >= tier.threshold) {
          discount = Math.max(discount, subtotal * (tier.percent / 100));
        }
      }
      
      const taxableAmount = Math.max(0, subtotal - discount);
      const tax = taxableAmount * TAX_RATE;
      const grandTotal = taxableAmount + tax;
      
      document.getElementById('subtotal').textContent = fmt(subtotal);
      document.getElementById('discount').textContent = '-' + fmt(discount);
      document.getElementById('tax').textContent = fmt(tax);
      document.getElementById('grand').textContent = fmt(grandTotal);
      
      const paypalContainer = document.getElementById('paypal-buttons');
      paypalContainer.innerHTML = '';
      
      if (cart.length > 0 && window.paypal) {
        try {
          paypal.Buttons({
            style: {
              layout: 'vertical',
              color: 'gold',
              shape: 'pill'
            },
            createOrder: function(data, actions) {
              return actions.order.create({
                purchase_units: [{
                  amount: {
                    value: grandTotal.toFixed(2),
                    currency_code: 'USD'
                  },
                  items: cart.map(item => ({
                    name: item.title,
                    quantity: item.qty,
                    unit_amount: {
                      value: item.price.toFixed(2),
                      currency_code: 'USD'
                    }
                  }))
                }]
              });
            },
            onApprove: function(data, actions) {
              return actions.order.capture().then(function(details) {
                cart = [];
                saveCart();
                closeCart();
                showThankYou();
              });
            },
            onError: function(err) {
              console.error('PayPal error:', err);
              alert('Payment error occurred');
            }
          }).render('#paypal-buttons');
        } catch (error) {
          console.error('PayPal render failed:', error);
        }
      }
    }

    function renderAdmin() {
      console.log('Rendering admin panel...');
      const adminList = document.getElementById('adminList');
      if (!adminList) {
        console.error('Admin list element not found!');
        return;
      }
      
      adminList.innerHTML = '';
      console.log('Products to display:', products.length);
      
      products.forEach(product => {
        const row = document.createElement('div');
        row.className = 'row';
        row.innerHTML = `
          <div class='grow'>
            <strong>${product.title}</strong><br>
            <span class='small'>${product.type} â€¢ ${fmt(product.price)}</span>
          </div>
          <button class='btn' onclick='editProduct("${product.id}")'>Edit</button>
          <button class='btn' onclick='deleteProduct("${product.id}")'>Del</button>
        `;
        adminList.appendChild(row);
      });
      console.log('Admin panel rendered with', products.length, 'products');
    }

  <script>
    // Global admin access - attach to window immediately
    var tapCount = 0;
    
    window.adminTap = function() {
      tapCount++;
      console.log('Taps:', tapCount);
      
      if (tapCount >= 5) {
        tapCount = 0;
        var pass = prompt('Admin password:');
        if (pass === 'vinyltherapy') {
          var admin = document.getElementById('admin');
          admin.style.display = 'block';
          admin.classList.add('show');
          renderAdmin();
          console.log('Admin opened!');
        } else if (pass) {
          alert('Wrong password');
        }
      }
      setTimeout(function() { tapCount = 0; }, 8000);
    };

    function hideAdmin() {
      var admin = document.getElementById('admin');
      admin.style.display = 'none';
      admin.classList.remove('show');
    }
</body>
</html>
